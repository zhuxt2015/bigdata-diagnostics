CREATE TABLE `dwd_task_instance` (
  `task_id` int(11) NOT NULL COMMENT "",
  `dt` date NOT NULL COMMENT "",
  `task_name` varchar(65533) NULL COMMENT "",
  `project_id` int(11) NOT NULL COMMENT "",
  `project_name` varchar(65533) NULL COMMENT "",
  `process_definition_id` int(11) NULL COMMENT "",
  `process_name` varchar(65533) NULL COMMENT "",
  `process_instance_id` int(11) NULL COMMENT "",
  `process_instance_name` varchar(65533) NULL COMMENT "",
  `task_type` varchar(65533) NULL COMMENT "",
  `task_json` json NULL COMMENT "",
  `state` tinyint(4) NULL COMMENT "",
  `submit_time` datetime NULL COMMENT "",
  `start_time` datetime NULL COMMENT "",
  `end_time` datetime NULL COMMENT "",
  `host` varchar(65533) NULL COMMENT "",
  `execute_path` varchar(65533) NULL COMMENT "",
  `log_path` varchar(65533) NULL COMMENT "",
  `alert_flag` tinyint(4) NULL COMMENT "",
  `retry_times` int(11) NULL COMMENT "",
  `pid` int(11) NULL COMMENT "",
  `app_link` varchar(65533) NULL COMMENT "",
  `flag` tinyint(4) NULL COMMENT "",
  `retry_interval` int(11) NULL COMMENT "",
  `max_retry_times` int(11) NULL COMMENT "",
  `task_instance_priority` int(11) NULL COMMENT "",
  `worker_group` varchar(65533) NULL COMMENT "",
  `executor_id` int(11) NULL COMMENT ""
) ENGINE=OLAP 
PRIMARY KEY(`task_id`, `dt`)
PARTITION BY RANGE(`dt`)
(PARTITION p202402 VALUES [("2024-02-01"), ("2024-03-01")),
PARTITION p202403 VALUES [("2024-03-01"), ("2024-04-01")),
PARTITION p202404 VALUES [("2024-04-01"), ("2024-05-01")),
PARTITION p202405 VALUES [("2024-05-01"), ("2024-06-01")),
PARTITION p202406 VALUES [("2024-06-01"), ("2024-07-01")),
PARTITION p202407 VALUES [("2024-07-01"), ("2024-08-01")),
PARTITION p202408 VALUES [("2024-08-01"), ("2024-09-01")),
PARTITION p202409 VALUES [("2024-09-01"), ("2024-10-01")),
PARTITION p202410 VALUES [("2024-10-01"), ("2024-11-01")),
PARTITION p202411 VALUES [("2024-11-01"), ("2024-12-01")),
PARTITION p202412 VALUES [("2024-12-01"), ("2025-01-01")),
PARTITION p202501 VALUES [("2025-01-01"), ("2025-02-01")),
PARTITION p202502 VALUES [("2025-02-01"), ("2025-03-01")),
PARTITION p202503 VALUES [("2025-03-01"), ("2025-04-01")),
PARTITION p202504 VALUES [("2025-04-01"), ("2025-05-01")))
DISTRIBUTED BY HASH(`dt`) BUCKETS 1 
PROPERTIES (
"compression" = "LZ4",
"dynamic_partition.buckets" = "1",
"dynamic_partition.enable" = "true",
"dynamic_partition.end" = "1",
"dynamic_partition.history_partition_num" = "0",
"dynamic_partition.prefix" = "p",
"dynamic_partition.start" = "-13",
"dynamic_partition.start_day_of_month" = "1",
"dynamic_partition.time_unit" = "month",
"dynamic_partition.time_zone" = "Asia/Shanghai",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"replication_num" = "3"
);

CREATE TABLE `dwd_task_applications` (
  `task_id` int(11) NOT NULL COMMENT "",
  `dt` date NOT NULL COMMENT "",
  `application_id` varchar(65533) NOT NULL COMMENT "",
  `task_name` varchar(65533) NULL COMMENT "",
  `project_id` int(11) NOT NULL COMMENT "",
  `project_name` varchar(65533) NULL COMMENT "",
  `process_definition_id` int(11) NULL COMMENT "",
  `process_name` varchar(65533) NULL COMMENT "",
  `process_instance_id` int(11) NULL COMMENT "",
  `process_instance_name` varchar(65533) NULL COMMENT "",
  `task_type` varchar(65533) NULL COMMENT "",
  `task_json` json NULL COMMENT "",
  `task_state` tinyint(4) NULL COMMENT "",
  `submit_time` datetime NULL COMMENT "",
  `start_time` datetime NULL COMMENT "",
  `end_time` datetime NULL COMMENT "",
  `host` varchar(65533) NULL COMMENT "",
  `execute_path` varchar(65533) NULL COMMENT "",
  `log_path` varchar(65533) NULL COMMENT "",
  `alert_flag` tinyint(4) NULL COMMENT "",
  `retry_times` int(11) NULL COMMENT "",
  `task_instance_priority` int(11) NULL COMMENT "",
  `worker_group` varchar(65533) NULL COMMENT "",
  `executor_id` int(11) NULL COMMENT "",
  `script` varchar(65533) NULL COMMENT "",
  `sql` json NULL COMMENT "",
  `user` varchar(65533) NULL COMMENT "",
  `application_name` varchar(65533) NULL COMMENT "",
  `queue` varchar(65533) NULL COMMENT "",
  `application_state` varchar(65533) NULL COMMENT "",
  `finalStatus` varchar(65533) NULL COMMENT "",
  `progress` int(11) NULL COMMENT "",
  `trackingUI` varchar(65533) NULL COMMENT "",
  `trackingUrl` varchar(65533) NULL COMMENT "",
  `diagnostics` varchar(65533) NULL COMMENT "",
  `clusterId` bigint(20) NULL COMMENT "",
  `applicationType` varchar(65533) NULL COMMENT "",
  `applicationTags` varchar(65533) NULL COMMENT "",
  `priority` int(11) NULL COMMENT "",
  `startedTime` bigint(20) NULL COMMENT "",
  `finishedTime` bigint(20) NULL COMMENT "",
  `elapsedTime` bigint(20) NULL COMMENT "",
  `amContainerLogs` varchar(65533) NULL COMMENT "",
  `amHostHttpAddress` varchar(65533) NULL COMMENT "",
  `allocatedMB` int(11) NULL COMMENT "",
  `allocatedVCores` int(11) NULL COMMENT "",
  `runningContainers` int(11) NULL COMMENT "",
  `memorySeconds` bigint(20) NULL COMMENT "",
  `vcoreSeconds` bigint(20) NULL COMMENT "",
  `queueUsagePercentage` int(11) NULL COMMENT "",
  `clusterUsagePercentage` int(11) NULL COMMENT "",
  `preemptedResourceMB` int(11) NULL COMMENT "",
  `preemptedResourceVCores` int(11) NULL COMMENT "",
  `numNonAMContainerPreempted` int(11) NULL COMMENT "",
  `numAMContainerPreempted` int(11) NULL COMMENT "",
  `logAggregationStatus` varchar(65533) NULL COMMENT "",
  `unmanagedApplication` boolean NULL COMMENT "",
  `amNodeLabelExpression` varchar(65533) NULL COMMENT ""
) ENGINE=OLAP 
PRIMARY KEY(`task_id`, `dt`, `application_id`)
PARTITION BY RANGE(`dt`)
(PARTITION p202402 VALUES [("2024-02-01"), ("2024-03-01")),
PARTITION p202403 VALUES [("2024-03-01"), ("2024-04-01")),
PARTITION p202404 VALUES [("2024-04-01"), ("2024-05-01")),
PARTITION p202405 VALUES [("2024-05-01"), ("2024-06-01")),
PARTITION p202406 VALUES [("2024-06-01"), ("2024-07-01")),
PARTITION p202407 VALUES [("2024-07-01"), ("2024-08-01")),
PARTITION p202408 VALUES [("2024-08-01"), ("2024-09-01")),
PARTITION p202409 VALUES [("2024-09-01"), ("2024-10-01")),
PARTITION p202410 VALUES [("2024-10-01"), ("2024-11-01")),
PARTITION p202411 VALUES [("2024-11-01"), ("2024-12-01")),
PARTITION p202412 VALUES [("2024-12-01"), ("2025-01-01")),
PARTITION p202501 VALUES [("2025-01-01"), ("2025-02-01")),
PARTITION p202502 VALUES [("2025-02-01"), ("2025-03-01")),
PARTITION p202503 VALUES [("2025-03-01"), ("2025-04-01")),
PARTITION p202504 VALUES [("2025-04-01"), ("2025-05-01")))
DISTRIBUTED BY HASH(`dt`) BUCKETS 1 
PROPERTIES (
"compression" = "LZ4",
"dynamic_partition.buckets" = "1",
"dynamic_partition.enable" = "true",
"dynamic_partition.end" = "1",
"dynamic_partition.history_partition_num" = "0",
"dynamic_partition.prefix" = "p",
"dynamic_partition.start" = "-13",
"dynamic_partition.start_day_of_month" = "1",
"dynamic_partition.time_unit" = "month",
"dynamic_partition.time_zone" = "Asia/Shanghai",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"replication_num" = "3"
);

CREATE TABLE `task_applications` (
  `task_id` int(11) NOT NULL COMMENT "",
  `dt` date NOT NULL COMMENT "",
  `application_id` varchar(65533) NOT NULL COMMENT "",
  `project_id` int(11) NULL COMMENT "",
  `process_definition_id` int(11) NULL COMMENT "",
  `process_instance_id` int(11) NULL COMMENT "",
  `script` varchar(65533) NULL COMMENT "",
  `sql` json NULL COMMENT "",
  `hive_query_id` varchar(65533) NULL COMMENT "",
  `task_start_time` datetime NULL COMMENT ""
) ENGINE=OLAP 
PRIMARY KEY(`task_id`, `dt`, `application_id`)
PARTITION BY RANGE(`dt`)
(PARTITION p202412 VALUES [("2024-12-01"), ("2025-01-01")),
PARTITION p202501 VALUES [("2025-01-01"), ("2025-02-01")),
PARTITION p202502 VALUES [("2025-02-01"), ("2025-03-01")),
PARTITION p202503 VALUES [("2025-03-01"), ("2025-04-01")),
PARTITION p202504 VALUES [("2025-04-01"), ("2025-05-01")))
DISTRIBUTED BY HASH(`task_id`, `dt`, `application_id`) BUCKETS 1 
PROPERTIES (
"compression" = "LZ4",
"dynamic_partition.buckets" = "1",
"dynamic_partition.enable" = "true",
"dynamic_partition.end" = "1",
"dynamic_partition.history_partition_num" = "0",
"dynamic_partition.prefix" = "p",
"dynamic_partition.start" = "-3",
"dynamic_partition.start_day_of_month" = "1",
"dynamic_partition.time_unit" = "MONTH",
"dynamic_partition.time_zone" = "Asia/Shanghai",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"replication_num" = "3"
);

CREATE TABLE `hiveserver2_query_log` (
  `query_id` varchar(65533) NOT NULL COMMENT "",
  `application_id` varchar(65533) NOT NULL COMMENT "",
  `dt` date NOT NULL COMMENT "",
  `query_time` datetime NULL COMMENT "",
  `hive_server_ip` varchar(65533) NULL COMMENT ""
) ENGINE=OLAP 
PRIMARY KEY(`query_id`, `application_id`, `dt`)
PARTITION BY RANGE(`dt`)
(PARTITION p202502 VALUES [("2025-02-01"), ("2025-03-01")),
PARTITION p202503 VALUES [("2025-03-01"), ("2025-04-01")),
PARTITION p202504 VALUES [("2025-04-01"), ("2025-05-01")))
DISTRIBUTED BY HASH(`query_id`) BUCKETS 1 
PROPERTIES (
"compression" = "LZ4",
"dynamic_partition.buckets" = "1",
"dynamic_partition.enable" = "true",
"dynamic_partition.end" = "1",
"dynamic_partition.history_partition_num" = "0",
"dynamic_partition.prefix" = "p",
"dynamic_partition.start" = "-1",
"dynamic_partition.start_day_of_month" = "1",
"dynamic_partition.time_unit" = "month",
"dynamic_partition.time_zone" = "Asia/Shanghai",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"replication_num" = "3"
);
CREATE TABLE `spark_task` (
  `application_id` varchar(65533) NOT NULL COMMENT "",
  `stage_stageId` int(11) NOT NULL COMMENT "",
  `task_taskId` int(11) NOT NULL COMMENT "",
  `stage_submissionTime` datetime NOT NULL COMMENT "",
  `stage_jobId` int(11) NULL COMMENT "",
  `stage_sqlId` int(11) NULL COMMENT "",
  `stage_status` varchar(65533) NULL COMMENT "",
  `stage_attemptId` int(11) NULL COMMENT "",
  `stage_numTasks` int(11) NULL COMMENT "",
  `stage_numActiveTasks` int(11) NULL COMMENT "",
  `stage_numCompleteTasks` int(11) NULL COMMENT "",
  `stage_numFailedTasks` int(11) NULL COMMENT "",
  `stage_numKilledTasks` int(11) NULL COMMENT "",
  `stage_numCompletedIndices` int(11) NULL COMMENT "",
  `stage_executorRunTime` bigint(20) NULL COMMENT "",
  `stage_executorCpuTime` bigint(20) NULL COMMENT "",
  `stage_firstTaskLaunchedTime` datetime NULL COMMENT "",
  `stage_completionTime` datetime NULL COMMENT "",
  `stage_inputBytes` bigint(20) NULL COMMENT "",
  `stage_inputRecords` bigint(20) NULL COMMENT "",
  `stage_outputBytes` bigint(20) NULL COMMENT "",
  `stage_outputRecords` bigint(20) NULL COMMENT "",
  `stage_shuffleReadBytes` bigint(20) NULL COMMENT "",
  `stage_shuffleReadRecords` bigint(20) NULL COMMENT "",
  `stage_shuffleWriteBytes` bigint(20) NULL COMMENT "",
  `stage_shuffleWriteRecords` bigint(20) NULL COMMENT "",
  `stage_memoryBytesSpilled` bigint(20) NULL COMMENT "",
  `stage_diskBytesSpilled` bigint(20) NULL COMMENT "",
  `stage_name` varchar(65533) NULL COMMENT "",
  `stage_schedulingPool` varchar(65533) NULL COMMENT "",
  `stage_rddIds` varchar(65533) NULL COMMENT "",
  `stage_accumulatorUpdates` varchar(65533) NULL COMMENT "",
  `stage_killedTasksSummary` varchar(65533) NULL COMMENT "",
  `task_index` int(11) NULL COMMENT "",
  `task_attempt` int(11) NULL COMMENT "",
  `task_launchTime` datetime NULL COMMENT "",
  `task_duration` bigint(20) NULL COMMENT "",
  `task_executorId` int(11) NULL COMMENT "",
  `task_host` varchar(65533) NULL COMMENT "",
  `task_status` varchar(65533) NULL COMMENT "",
  `task_taskLocality` varchar(65533) NULL COMMENT "",
  `task_speculative` boolean NULL COMMENT "",
  `task_accumulatorUpdates` varchar(65533) NULL COMMENT "",
  `task_executorDeserializeTime` bigint(20) NULL COMMENT "",
  `task_executorDeserializeCpuTime` bigint(20) NULL COMMENT "",
  `task_executorRunTime` bigint(20) NULL COMMENT "",
  `task_executorCpuTime` bigint(20) NULL COMMENT "",
  `task_resultSize` bigint(20) NULL COMMENT "",
  `task_jvmGcTime` bigint(20) NULL COMMENT "",
  `task_resultSerializationTime` bigint(20) NULL COMMENT "",
  `task_memoryBytesSpilled` bigint(20) NULL COMMENT "",
  `task_diskBytesSpilled` bigint(20) NULL COMMENT "",
  `task_peakExecutionMemory` bigint(20) NULL COMMENT "",
  `task_bytesRead` bigint(20) NULL COMMENT "",
  `task_recordsRead` bigint(20) NULL COMMENT "",
  `task_bytesWritten` bigint(20) NULL COMMENT "",
  `task_recordsWritten` bigint(20) NULL COMMENT "",
  `task_shuffle_remoteBlocksFetched` bigint(20) NULL COMMENT "",
  `task_shuffle_localBlocksFetched` bigint(20) NULL COMMENT "",
  `task_shuffle_fetchWaitTime` bigint(20) NULL COMMENT "",
  `task_shuffle_remoteBytesRead` bigint(20) NULL COMMENT "",
  `task_shuffle_remoteBytesReadToDisk` bigint(20) NULL COMMENT "",
  `task_shuffle_localBytesRead` bigint(20) NULL COMMENT "",
  `task_shuffle_recordsRead` bigint(20) NULL COMMENT "",
  `task_shuffle_bytesWritten` bigint(20) NULL COMMENT "",
  `task_shuffle_writeTime` bigint(20) NULL COMMENT "",
  `task_shuffle_recordsWritten` bigint(20) NULL COMMENT ""
) ENGINE=OLAP 
PRIMARY KEY(`application_id`, `stage_stageId`, `task_taskId`, `stage_submissionTime`)
PARTITION BY RANGE(`stage_submissionTime`)
(PARTITION p202412 VALUES [("2024-12-01 00:00:00"), ("2025-01-01 00:00:00")),
PARTITION p202501 VALUES [("2025-01-01 00:00:00"), ("2025-02-01 00:00:00")),
PARTITION p202502 VALUES [("2025-02-01 00:00:00"), ("2025-03-01 00:00:00")),
PARTITION p202503 VALUES [("2025-03-01 00:00:00"), ("2025-04-01 00:00:00")),
PARTITION p202504 VALUES [("2025-04-01 00:00:00"), ("2025-05-01 00:00:00")))
DISTRIBUTED BY HASH(`application_id`, `stage_stageId`) BUCKETS 3 
PROPERTIES (
"compression" = "LZ4",
"dynamic_partition.buckets" = "1",
"dynamic_partition.enable" = "true",
"dynamic_partition.end" = "1",
"dynamic_partition.history_partition_num" = "0",
"dynamic_partition.prefix" = "p",
"dynamic_partition.start" = "-3",
"dynamic_partition.start_day_of_month" = "1",
"dynamic_partition.time_unit" = "MONTH",
"dynamic_partition.time_zone" = "Asia/Shanghai",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"replication_num" = "3"
);